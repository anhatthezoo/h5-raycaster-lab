var O2 = require('o2');
var classmagic = require('classmagic');

var ServiceChain = O2.createClass({
	_aServices: null,
	
	/**
	 * Ajoute un service asynchrone à la chaine
	 * @param pServ function
	 */
	addService: function(pServ) {
		if (!this._aServices) {
			this._aServices = [];
		}
		this._aServices.push(pServ);
	},

	/**
	 * Exécute le prochain service de la chaine
	 */
	next: function() {
		var pServ = this._aServices.shift();
		if (pServ) {
			pServ(this);
		}
	}
});

classmagic.castDataManager(ServiceChain);

module.exports = ServiceChain;
